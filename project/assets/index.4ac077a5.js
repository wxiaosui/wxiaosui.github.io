import{_ as k}from"./index.b9c3985b.js";import{o as a,f as i,g as m,h as E,F as w,j as I,n as B,k as M,l as D,m as x,u as g,r as S,c as T,w as $,p as O,q as G,s as A,t as P,v as z,x as X,y as j,z as L,A as H,B as R,C as U,E as J,D as N,G as W}from"./vendor.a0fca97d.js";const q={},K={class:"container"},Q={class:"workspacr"},Z={class:"sidebar"};function ee(t,n){return a(),i("div",K,[m("div",Q,[E(t.$slots,"workspace",{},void 0,!0)]),m("div",Z,[E(t.$slots,"sidebar",{},void 0,!0)])])}var te=k(q,[["render",ee],["__scopeId","data-v-22c128f7"]]);const oe={name:"FlowGrid",props:{spaceSize:{type:Number,default:5e3},gridSize:{type:Number,default:20},visibility:{type:String,default:"visible"}},data(){return{}},computed:{gridTicks:function(){const t=[];for(let n=0;n<this.spaceSize;n+=+this.gridSize)t.push(n);return t}}},se=["x2","y1","y2"],ne=["x1","x2","y2"];function ae(t,n,d,f,_,s){return a(),i("g",{class:"grid",style:B({visibility:d.visibility})},[(a(!0),i(w,null,I(s.gridTicks,o=>(a(),i("line",{key:`flow-grid-horizontal-${o}`,class:"horizontal",x1:"0",x2:d.spaceSize,y1:o,y2:o,fill:"node","shape-rendering":"crispEdges",stroke:"#eee","stroke-width":"1px"},null,8,se))),128)),(a(!0),i(w,null,I(s.gridTicks,o=>(a(),i("line",{key:`flow-grid-vertical-${o}`,class:"vertical",x1:o,x2:o,y1:"0",y2:d.spaceSize,fill:"node","shape-rendering":"crispEdges",stroke:"#eee","stroke-width":"1px"},null,8,ne))),128))],4)}var re=k(oe,[["render",ae]]);const ce=["id","cx","cy"],le={props:{activeItem:Array},emits:["boxstart","boxmove","boxend"],setup(t,{emit:n}){M(()=>{});const d=function(s){n("boxstart",s),s.stopPropagation()},f=function(s){n("boxmove",s),s.preventDefault(),s.stopPropagation()},_=function(s){n("boxend",s),s.stopPropagation()};return(s,o)=>(a(),i("g",null,[(a(!0),i(w,null,I(t.activeItem,(v,r)=>(a(),i("circle",{key:v.id,id:v.id,cx:v.x,cy:v.y,r:"10",class:"port",onTouchstart:d,onTouchmove:f,onTouchend:_},null,40,ce))),128))]))}};var ie=k(le,[["__scopeId","data-v-4c0d7a60"]]);const de=["transform"],ue=["x1","y1","x2","y2","id","transform"],_e={props:{group:Array,scale:Number},setup(t){const n=t,d=D(()=>{let r=n.group.filter(e=>e.checked)[0];return r?{arr:[{x:r.x1,y:r.y1,id:"l"},{x:r.x2,y:r.y2,id:"r"}],trs:{x:r.x,y:r.y}}:{arr:[],trs:{x:0,y:0}}}),f=function(r){r.stopPropagation()};let _={};const s=function(r){n.group.filter(c=>c.checked),JSON.parse(JSON.stringify);let e=r.touches[0];_={x:e.clientX,y:e.clientY}},o=function(r){let e=n.group.filter(b=>b.checked),c=r.touches[0],h=r.target.id;console.log(_.x),e&&(h==="r"?(e[0].x2=c.pageX-e[0].x,e[0].y2=c.pageY-35-e[0].y):h==="l"&&(e[0].x1=c.pageX-e[0].x,e[0].y1=c.pageY-35-e[0].y))},v=function(r){};return(r,e)=>(a(),i("g",null,[(a(!0),i(w,null,I(t.group,(c,h)=>(a(),i("g",{key:c.id,transform:`translate(${c.x},${c.y})`},[m("line",{stroke:"#000000",class:"line","stroke-dasharray":"null","stroke-linejoin":"null","stroke-linecap":"null",x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,id:c.id,"fill-opacity":"0.5","stroke-opacity":"1",transform:`rotate(${c.rotate})`,onClick:f},null,8,ue)],8,de))),128)),x(ie,{activeItem:g(d).arr,transform:`translate(${g(d).trs.x},${g(d).trs.y})`,onBoxstart:s,onBoxmove:o,onBoxend:v},null,8,["activeItem","transform"])]))}};var pe=k(_e,[["__scopeId","data-v-2f10fedc"]]);const fe=t=>(G("data-v-5df152c5"),t=t(),A(),t),ve={class:"edit-header"},he={class:"header-l"},ye=fe(()=>m("div",{class:"divider"},null,-1)),ge={class:"header-r"},xe=P("\u4FDD\u5B58"),me={props:{itemGroups:{type:Array,default:function(){return[{name:"edit",items:[{label:"\u5220\u9664",name:"delete"}]}]}},actives:{type:Object,default:function(){return{copy:!1,paste:!1,delete:!1,addGroup:!1,ungroup:!1}}}},emits:["tarbar-action","submit"],setup(t,{emit:n}){const d=t;function f(o){return!d.actives[o]}const _=function(o){n("tarbar-action",o)},s=function(){n("submit")};return(o,v)=>{const r=S("el-icon"),e=S("el-button"),c=S("el-tooltip");return a(),i("div",ve,[m("div",he,[(a(!0),i(w,null,I(t.itemGroups,h=>(a(),i("div",{key:h.name,class:"group"},[(a(!0),i(w,null,I(h.items,b=>(a(),T(c,{key:b.name,class:"item",effect:"dark",content:b.label,placement:"bottom"},{default:$(()=>[x(e,{disabled:f(b.name),class:"command",onClick:C=>_(b.name)},{default:$(()=>[x(r,null,{default:$(()=>[(a(),T(O(b.name)))]),_:2},1024)]),_:2},1032,["disabled","onClick"])]),_:2},1032,["content"]))),128)),ye]))),128))]),m("div",ge,[x(e,{onClick:s},{default:$(()=>[xe]),_:1})])])}}};var be=k(me,[["__scopeId","data-v-5df152c5"]]);const ke=["id"],$e={props:{data:{type:Object,default:{id:0,style:"",name:""}}},emits:["addsopes"],setup(t,{emit:n}){const d=t,f=function(){n("addsopes")},_=function(o){o.dataTransfer.setData("node_id",d.data.id),o.dataTransfer.setData("node_touch_x",o.offsetX),o.dataTransfer.setData("node_touch_y",o.offsetY)},s=function(o){o.dataTransfer.clearData()};return(o,v)=>(a(),i("div",{class:"sopes",id:t.data.id,style:B(t.data.style),draggable:"true",onDragstart:_,onDragend:s,onTouchend:f},"line",44,ke))}};var we=k($e,[["__scopeId","data-v-3cdb6247"]]);const Ie=t=>(G("data-v-30983cf5"),t=t(),A(),t),Se={class:"work-space"},ze=["width","height"],Te=["transform"],De=["width","height"],Ce=Ie(()=>m("div",null," edit ",-1)),Ee={class:"footer-buttons"},Ne=P(" \xA0 "),Be={props:{group:Array},setup(t){const n=t,d=z(1e3),f=z(1e3),_=z(20),s=z(1),o=X({delete:!1}),v=z(null),r=j(),e=n.group;D(()=>(console.log(v),0));const c=function(u){console.log(u),e.push({x1:300,y1:300,x2:400,y2:300,x:0,y:0,id:`svg_${e.length+1}`,rotate:0,checked:!1})};let h={};const b=function(u){console.log(u);let l=u.touches[0];h={x:l.clientX,y:l.clientY};let p=e.filter(y=>y.checked);p.length>=1&&(h.ox=p[0].x,h.oy=p[0].y),u.stopPropagation()};function C(u){if(u==="delete"){let l=e.findIndex(p=>p.checked);l!=-1&&J.confirm("\u786E\u8BA4\u5220\u9664\u6B64\u8282\u70B9?","Warning",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{e.splice(l,1),o.delete=!1,N({type:"success",message:"\u5220\u9664\u6210\u529F"})}).catch(()=>{N({type:"info",message:"\u5DF2\u53D6\u6D88"})})}}const V=function(u){u.stopPropagation();let l=e.filter(y=>y.checked),p=u.touches[0];l.length>=1&&(u.preventDefault(),l[0].x=p.clientX-h.x+h.ox,l[0].y=p.clientY-h.y+h.oy)},Y=function(u){let l=u.target.id,p=u.target.localName;l?p==="line"&&e.forEach(y=>{y.id!==l?y.checked=!1:(y.checked=!0,o.delete=!0)}):e.forEach(y=>{y.checked=!1,o.delete=!1}),u.stopPropagation()},F=function(){let u=v.value,l=new XMLSerializer,p=`<?xml version="1.0" standalone="no"?>\r
`+l.serializeToString(u);const y="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(p);r.push({name:"sampeol",params:{src:y}})};return(u,l)=>{const p=S("el-button");return a(),i("div",Se,[x(g(be),{actives:g(o),onTarbarAction:C,onSubmit:F},null,8,["actives"]),m("div",{class:"cart",onDrop:c,onDragover:l[0]||(l[0]=L(()=>{},["prevent"]))},[(a(),i("svg",{ref_key:"svgContent",ref:v,width:d.value,height:f.value,"pointer-events":"all",style:{cursor:"crosshair"}},[m("g",null,[m("g",{transform:`scale(${s.value})`,onTouchstart:b,onTouchmove:V,onTouchend:Y},[m("rect",{class:"outer_background",width:d.value,height:f.value,fill:"#fff"},null,8,De),x(g(re),{spaceSize:d.value,gridSize:_.value},null,8,["spaceSize","gridSize"]),x(g(pe),{scale:s.value,group:g(e)},null,8,["scale","group"])],40,Te)])],8,ze))],32),m("footer",null,[Ce,m("div",Ee,[x(p,{icon:g(H),onClick:l[1]||(l[1]=y=>s.value-=.1)},null,8,["icon"]),x(p,{icon:g(R),onClick:l[2]||(l[2]=y=>s.value=1)},null,8,["icon"]),x(p,{icon:g(U),onClick:l[3]||(l[3]=y=>s.value+=.1)},null,8,["icon"]),Ne])])])}}};var Ge=k(Be,[["__scopeId","data-v-30983cf5"]]);const Ae={class:"scroll"},Pe={props:{filterGroups:{type:Array,default:[{id:1,title:"\u56FE\u5E93",nodes:[{id:1,name:"line"}]}]}},emits:["updatesopes"],setup(t,{emit:n}){const d=t,f=function(){n("updatesopes")},_=D(()=>d.filterGroups.map(s=>s.id));return(s,o)=>{const v=S("el-collapse-item"),r=S("el-collapse");return a(),i("div",Ae,[x(r,{modelValue:g(_),"onUpdate:modelValue":o[0]||(o[0]=e=>W(_)?_.value=e:null)},{default:$(()=>[(a(!0),i(w,null,I(t.filterGroups,e=>(a(),T(v,{key:e.id,title:e.title,name:e.id},{default:$(()=>[(a(!0),i(w,null,I(e.nodes,c=>(a(),T(g(we),{onAddsopes:f,key:c.id,data:c},null,8,["data"]))),128))]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])])}}};var Xe=k(Pe,[["__scopeId","data-v-75a290dc"]]);const Ve={class:"edit"},Ye={setup(t){const n=X([]),d=function(){n.push({x1:300,y1:300,x2:400,y2:300,x:0,y:0,id:`svg_${n.length+1}`,rotate:0,checked:!1}),console.log(n)};return(f,_)=>(a(),i("div",Ve,[x(te,null,{workspace:$(()=>[x(Ge,{group:g(n)},null,8,["group"])]),sidebar:$(()=>[x(Xe,{onUpdatesopes:d})]),_:1})]))}};var Oe=k(Ye,[["__scopeId","data-v-222fcb5a"]]);export{Oe as default};
